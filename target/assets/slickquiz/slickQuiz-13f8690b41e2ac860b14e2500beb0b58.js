(function(e){e.slickQuiz=function(t,n){var r=this,s=e(t),o="#"+s.attr("id"),u={checkAnswerText:"Vérifier ma réponse !",nextQuestionText:"Suivant &raquo;",backButtonText:"Précédent &raquo;",completeQuizText:"",tryAgainText:"Rejouer",questionCountText:"Question %current de %total",preventUnansweredText:"Vous devez sélectionner au moins une réponse.",questionTemplateText:"%count. %text",scoreTemplateText:"%score / %total",nameTemplateText:"<span>Quiz: </span>%name",skipStartButton:false,numberOfQuestions:null,randomSortQuestions:true,randomSortAnswers:false,preventUnanswered:false,disableScore:false,disableRanking:false,perQuestionResponseMessaging:true,perQuestionResponseAnswers:false,completionResponseMessaging:false,displayQuestionCount:true,displayQuestionNumber:true,animationCallbacks:{setupQuiz:function(){},startQuiz:function(){},resetQuiz:function(){},checkAnswer:function(){},nextQuestion:function(){},backToQuestion:function(){},completeQuiz:function(){}},events:{onStartQuiz:function(e){},onCompleteQuiz:function(e){}}},a="questionCount",f="questions",l="question",c="answers",h="responses",p="correctResponse",d="incorrectResponse",v="correct",m="incorrect",g="checkAnswer",y="nextQuestion",b="lastQuestion",w="backToQuestion",E="tryAgain",S="."+a,x="."+f,T="."+l,N="."+c,C="."+c+" li",k="."+h,L="."+h+" li",A="."+p,O="."+v,M="."+m,_="."+g,D="."+y,P="."+w,H="."+E,B=o+" .startQuiz",j=o+" .quizName",F=o+" .quizArea",I=o+" .quizResults",q=o+" .quizResultsCopy",R=o+" .quizHeader",U=o+" .quizScore",z=o+" .quizLevel",W=e(B),X=e(j),V=e(F),J=e(I),K=e(q),Q=e(R),G=e(U),Y=e(z);var Z="";if(n&&typeof n.disableNext!="undefined"){if(typeof n.preventUnanswered=="undefined"){n.preventUnanswered=n.disableNext}Z+="The 'disableNext' option has been deprecated, please use 'preventUnanswered' in it's place.\n\n"}if(n&&typeof n.disableResponseMessaging!="undefined"){if(typeof n.preventUnanswered=="undefined"){n.perQuestionResponseMessaging=n.disableResponseMessaging}Z+="The 'disableResponseMessaging' option has been deprecated, please use"+" 'perQuestionResponseMessaging' and 'completionResponseMessaging' in it's place.\n\n"}if(n&&typeof n.randomSort!="undefined"){if(typeof n.randomSortQuestions=="undefined"){n.randomSortQuestions=n.randomSort}if(typeof n.randomSortAnswers=="undefined"){n.randomSortAnswers=n.randomSort}Z+="The 'randomSort' option has been deprecated, please use"+" 'randomSortQuestions' and 'randomSortAnswers' in it's place.\n\n"}if(Z!==""){if(typeof console!="undefined"){console.warn(Z)}else{alert(Z)}}r.config=e.extend(u,n);var et=r.config.json?r.config.json:typeof quizJSON!="undefined"?quizJSON:null;var tt=r.config.randomSortQuestions?et.questions.sort(function(){return Math.round(Math.random())-.5}):et.questions;var nt=tt.length;if(r.config.numberOfQuestions&&nt>=r.config.numberOfQuestions){tt=tt.slice(0,r.config.numberOfQuestions);nt=tt.length}var rt={method:{getKey:function(t){var n=[];for(i=0;i<t;i++)n[i]=e.Deferred();return n},turnKeyAndGo:function(t,n){e.when.apply(null,t).then(function(){n()})},getKeyNotch:function(e,t){return function(){e[t-1].resolve()}}}};r.method={setupQuiz:function(t){var n,s,o;n=rt.method.getKey(3);s=rt.method.getKeyNotch;o=s;X.hide().html(r.config.nameTemplateText.replace("%name",et.info.name)).fadeIn(1e3,o(n,1));Q.hide().prepend(e('<div class="quizDescription">'+et.info.main+"</div>")).fadeIn(1e3,o(n,2));K.append(et.info.results);if(r.config.tryAgainText&&r.config.tryAgainText!==""){K.append('<p><a class="button '+E+'" href="#">'+r.config.tryAgainText+"</a></p>")}var u=e('<ol class="'+f+'"></ol>'),p=1;for(i in tt){if(tt.hasOwnProperty(i)){var d=tt[i];var S=e('<li class="'+l+'" id="question'+(p-1)+'"></li>');if(r.config.displayQuestionCount){S.append('<div class="'+a+'">'+r.config.questionCountText.replace("%current",'<span class="current">'+p+"</span>").replace("%total",'<span class="total">'+nt+"</span>")+"</div>")}var x="";if(r.config.displayQuestionNumber){x=r.config.questionTemplateText.replace("%count",p).replace("%text",d.q)}else{x=d.q}S.append("<h3>"+x+"</h3>");var T=0;for(i in d.a){if(d.a.hasOwnProperty(i)){answer=d.a[i];if(answer.correct){T++}}}var N=e('<ul class="'+c+'"></ul>');var C=r.config.randomSortAnswers?d.a.sort(function(){return Math.round(Math.random())-.5}):d.a;var k=d.select_any?d.select_any:false,L=d.force_checkbox?d.force_checkbox:false,A=T>1&&!k||L,O="question"+(p-1),M=A?"checkbox":"radio";if(p==et.questions.length){y=y+" "+b}for(i in C){if(C.hasOwnProperty(i)){answer=C[i],optionId=O+"_"+i.toString();var _='<input id="'+optionId+'" name="'+O+'" type="'+M+'" /> ';var D='<label for="'+optionId+'">'+answer.option+"</label>";var P=e("<li></li>").append(_).append(D);N.append(P)}}S.append(N);if(r.config.perQuestionResponseMessaging||r.config.completionResponseMessaging){var H=e('<ul class="'+h+'"></ul>');H.append('<li class="'+v+'">'+d.correct+"</li>");H.append('<li class="'+m+'">'+d.incorrect+"</li>");S.append(H)}if(r.config.backButtonText&&r.config.backButtonText!==""){S.append('<a href="#" class="button '+w+'">'+r.config.backButtonText+"</a>")}var B=r.config.nextQuestionText;if(r.config.completeQuizText&&p==nt){B=r.config.completeQuizText}if(!r.config.perQuestionResponseMessaging){S.append('<a href="#" class="button '+y+" "+g+'">'+B+"</a>")}else{S.append('<a href="#" class="button '+y+'">'+B+"</a>");S.append('<a href="#" class="button '+g+'">'+r.config.checkAnswerText+"</a>")}u.append(S);p++}}V.append(u);if(r.config.skipStartButton||W.length==0){W.hide();r.method.startQuiz.apply(this,[{callback:r.config.animationCallbacks.startQuiz}]);o(n,3).apply(null,[])}else{W.fadeIn(500,o(n,3))}rt.method.turnKeyAndGo(n,t&&t.callback?t.callback:function(){})},startQuiz:function(t){function u(t){var n=e(o+" "+x+" li").first();if(n.length){n.fadeIn(500,function(){if(t&&t.callback)t.callback()})}}var n,i,s;n=rt.method.getKey(1);i=rt.method.getKeyNotch;s=i;if(r.config.skipStartButton||W.length==0){u({callback:s(n,1)})}else{W.fadeOut(300,function(){u({callback:s(n,1)})})}rt.method.turnKeyAndGo(n,t&&t.callback?t.callback:function(){});if(r.config.events&&r.config.events.onStartQuiz){r.config.events.onStartQuiz.apply(null,[])}},resetQuiz:function(t,n){var i,s,u;i=rt.method.getKey(1);s=rt.method.getKeyNotch;u=s;J.fadeOut(300,function(){e(o+" input").prop("checked",false).prop("disabled",false);Y.attr("class","quizLevel");e(o+" "+T).removeClass(p).removeClass(d);e(o+" "+C).removeClass(v).removeClass(m);e(o+" "+T+","+o+" "+k+","+o+" "+L+","+o+" "+D+","+o+" "+P).hide();e(o+" "+S+","+o+" "+N+","+o+" "+_).show();V.append(e(o+" "+x)).show();u(i,1).apply(null,[]);r.method.startQuiz({callback:r.config.animationCallbacks.startQuiz},J)});rt.method.turnKeyAndGo(i,n&&n.callback?n.callback:function(){})},checkAnswer:function(t,n){var s,o,u;s=rt.method.getKey(2);o=rt.method.getKeyNotch;u=o;var a=e(e(t).parents(T)[0]),f=a.find(N+" li"),l=f.find("input:checked"),c=parseInt(a.attr("id").replace(/(question)/,""),10),h=tt[c].a,g=tt[c].select_any?tt[c].select_any:false;f.addClass(m);var y=[];for(i in h){if(h.hasOwnProperty(i)){var b=h[i],w=parseInt(i,10);if(b.correct){y.push(w);f.eq(w).removeClass(m).addClass(v)}}}var E=[];l.each(function(){var t=e(this).attr("id");E.push(parseInt(t.replace(/(question\d{1,}_)/,""),10))});if(r.config.preventUnanswered&&E.length===0){alert(r.config.preventUnansweredText);return false}var S=r.method.compareAnswers(y,E,g);if(S){a.addClass(p)}else{a.addClass(d)}a.find(S?O:M).show();if(r.config.perQuestionResponseMessaging){e(t).hide();if(!r.config.perQuestionResponseAnswers){a.find(N).hide()}a.find("input").prop("disabled",true);a.find(k).show();a.find(D).fadeIn(300,u(s,1));a.find(P).fadeIn(300,u(s,2));if(!a.find(P).length)u(s,2).apply(null,[])}else{u(s,1).apply(null,[]);u(s,2).apply(null,[])}rt.method.turnKeyAndGo(s,n&&n.callback?n.callback:function(){})},nextQuestion:function(t,n){var i,s,o;i=rt.method.getKey(1);s=rt.method.getKeyNotch;o=s;var u=e(e(t).parents(T)[0]),a=u.next(T),f=u.find("input:checked");if(r.config.preventUnanswered&&f.length===0){return false}if(a.length){u.fadeOut(300,function(){a.find(P).show().end().fadeIn(500,o(i,1));if(!a.find(P).show().end().length)o(i,1).apply(null,[])})}else{o(i,1).apply(null,[]);r.method.completeQuiz({callback:r.config.animationCallbacks.completeQuiz})}rt.method.turnKeyAndGo(i,n&&n.callback?n.callback:function(){})},backToQuestion:function(t,n){var r,i,s;r=rt.method.getKey(2);i=rt.method.getKeyNotch;s=i;var o=e(e(t).parents(T)[0]),u=o.find(k);if(u.css("display")==="block"){o.find(k).fadeOut(300,function(){o.removeClass(p).removeClass(d);o.find(k+", "+L).hide();o.find(N).show();o.find(C).removeClass(v).removeClass(m);o.find("input").prop("disabled",false);o.find(N).fadeIn(500,s(r,1));o.find(_).fadeIn(500,s(r,2));o.find(D).hide();if(o.attr("id")!="question0"){o.find(P).show()}else{o.find(P).hide()}})}else{var a=o.prev(T);o.fadeOut(300,function(){a.removeClass(p).removeClass(d);a.find(k+", "+L).hide();a.find(N).show();a.find(C).removeClass(v).removeClass(m);a.find("input").prop("disabled",false);a.find(D).hide();a.find(_).show();if(a.attr("id")!="question0"){a.find(P).show()}else{a.find(P).hide()}a.fadeIn(500,s(r,1));s(r,2).apply(null,[])})}rt.method.turnKeyAndGo(r,n&&n.callback?n.callback:function(){})},completeQuiz:function(t){var n,i,s;n=rt.method.getKey(1);i=rt.method.getKeyNotch;s=i;var u=e(o+" "+A).length;if(r.config.disableScore){e(U).remove()}else{e(U+" span").html(r.config.scoreTemplateText.replace("%score",u).replace("%total",nt))}if(r.config.disableRanking){e(z).remove()}else{var a=[et.info.level1,et.info.level2,et.info.level3,et.info.level4,et.info.level5],f=r.method.calculateLevel(u),l=e.isNumeric(f)?a[f]:"";e(z+" span").html(l);e(z).addClass("level"+f)}V.fadeOut(300,function(){if(r.config.completionResponseMessaging){e(o+" .button:not("+H+"), "+o+" "+S).hide();e(o+" "+T+", "+o+" "+N+", "+o+" "+k).show();J.append(e(o+" "+x)).fadeIn(500,s(n,1))}else{J.fadeIn(500,s(n,1))}});rt.method.turnKeyAndGo(n,t&&t.callback?t.callback:function(){});if(r.config.events&&r.config.events.onCompleteQuiz){r.config.events.onCompleteQuiz.apply(null,[{questionCount:nt,score:u}])}},compareAnswers:function(t,n,r){if(r){return e.inArray(n[0],t)>-1}else{return e(t).not(n).length===0&&e(n).not(t).length===0}},calculateLevel:function(e){var t=(e/nt).toFixed(2),n=null;if(r.method.inRange(0,.2,t)){n=4}else if(r.method.inRange(.21,.4,t)){n=3}else if(r.method.inRange(.41,.6,t)){n=2}else if(r.method.inRange(.61,.8,t)){n=1}else if(r.method.inRange(.81,1,t)){n=0}return n},inRange:function(e,t,n){return n>=e&&n<=t}};r.init=function(){r.method.setupQuiz.apply(null,[{callback:r.config.animationCallbacks.setupQuiz}]);W.on("click",function(t){t.preventDefault();if(!this.disabled&&!e(this).hasClass("disabled")){r.method.startQuiz.apply(null,[{callback:r.config.animationCallbacks.startQuiz}])}});e(o+" "+H).on("click",function(e){e.preventDefault();r.method.resetQuiz(this,{callback:r.config.animationCallbacks.resetQuiz})});e(o+" "+_).on("click",function(e){e.preventDefault();r.method.checkAnswer(this,{callback:r.config.animationCallbacks.checkAnswer})});e(o+" "+P).on("click",function(e){e.preventDefault();r.method.backToQuestion(this,{callback:r.config.animationCallbacks.backToQuestion})});e(o+" "+D).on("click",function(e){e.preventDefault();r.method.nextQuestion(this,{callback:r.config.animationCallbacks.nextQuestion})});var t=s.attr("id")+"-name";X.attr("id",t);s.attr({"aria-labelledby":t,"aria-live":"polite","aria-relevant":"additions",role:"form"});e(B+', [href = "#"]').attr("role","button")};r.init()};e.fn.slickQuiz=function(t){return this.each(function(){if(undefined===e(this).data("slickQuiz")){var n=new e.slickQuiz(this,t);e(this).data("slickQuiz",n)}})}})(jQuery)