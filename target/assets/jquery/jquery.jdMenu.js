$(function(){$("ul.jd_menu").jdMenu()});(function(e){function t(t){var i=e.data(e(t).parents().andSelf().filter("ul.jd_menu")[0],"jdMenuSettings");e("> li",t).bind("mouseenter.jdmenu mouseleave.jdmenu",function(t){e(this).toggleClass("jdm_hover");var s=e("> ul",this);if(s.length==1){clearTimeout(this.$jdTimer);var o=t.type=="mouseenter";var u=o?n:r;this.$jdTimer=setTimeout(function(){u(s[0],i.onAnimate,i.isVertical)},o?i.showDelay:i.hideDelay)}}).bind("click.jdmenu",function(t){var r=e("> ul",this);if(r.length==1&&(i.disableLinks==true||e(this).hasClass("accessible"))){n(r,i.onAnimate,i.isVertical);return false}if(t.target==this){var s=e("> a",t.target).not(".accessible");if(s.length>0){var o=s[0];if(!o.onclick){window.open(o.href,o.target||"_self")}else{e(o).trigger("click")}}}if(i.disableLinks||!i.disableLinks&&!e(this).parent().hasClass("jd_menu")){e(this).parent().jdMenuHide();t.stopPropagation()}}).find("> a").bind("focus.jdmenu blur.jdmenu",function(t){var n=e(this).parents("li:eq(0)");if(t.type=="focus"){n.addClass("jdm_hover")}else{n.removeClass("jdm_hover")}}).filter(".accessible").bind("click.jdmenu",function(e){e.preventDefault()})}function n(n,i,s){var n=e(n);if(n.is(":visible")){return}n.bgiframe();var o=n.parent();n.trigger("jdMenuShow").positionBy({target:o[0],targetPos:s===true||!o.parent().hasClass("jd_menu")?1:3,elementPos:0,hideAfterPosition:true});if(!n.hasClass("jdm_events")){n.addClass("jdm_events");t(n)}o.addClass("jdm_active").siblings("li").find("> ul:eq(0):visible").each(function(){r(this)});if(i===undefined){n.show()}else{i.apply(n[0],[true])}}function r(t,n){var t=e(t);e(".bgiframe",t).remove();t.filter(":not(.jd_menu)").find("> li > ul:eq(0):visible").each(function(){r(this)}).end();if(n===undefined){t.hide()}else{n.apply(t[0],[false])}t.trigger("jdMenuHide").parents("li:eq(0)").removeClass("jdm_active jdm_hover").end().find("> li").removeClass("jdm_active jdm_hover")}e.fn.jdMenu=function(n){var n=e.extend({showDelay:200,hideDelay:500,disableLinks:true},n);if(!e.isFunction(n.onAnimate)){n.onAnimate=undefined}return this.filter("ul.jd_menu").each(function(){e.data(this,"jdMenuSettings",e.extend({isVertical:e(this).hasClass("jd_menu_vertical")},n));t(this)})};e.fn.jdMenuUnbind=function(){e("ul.jdm_events",this).unbind(".jdmenu").find("> a").unbind(".jdmenu")};e.fn.jdMenuHide=function(){return this.filter("ul").each(function(){r(this)})};e(window).bind("click.jdmenu",function(){e("ul.jd_menu ul:visible").jdMenuHide()})})(jQuery)